"use strict";(self["webpackChunkwpa_gereco"]=self["webpackChunkwpa_gereco"]||[]).push([[670],{3670:function(e,t,a){a.r(t),a.d(t,{default:function(){return ye}});var n=a(8473);const i={class:"VH"};function l(e,t,a,l,r,s){const o=(0,n.up)("VH");return(0,n.wg)(),(0,n.iD)("div",i,[(0,n.Wm)(o,{msg:"Welcome to Your Vue.js App"})])}var r=a(9197),s=a(4887),o=a(3630),_=a(2957);const u=e=>((0,n.dD)("data-v-58c89ef9"),e=e(),(0,n.Cn)(),e),d={class:"form_header"},p={class:"header_headline"},m=u((()=>(0,n._)("a",{href:"/"},[(0,n._)("img",{class:"return_button",src:o})],-1))),c=u((()=>(0,n._)("img",{src:_},null,-1))),h=u((()=>(0,n._)("h2",null,"RA",-1))),v=["value"],g=u((()=>(0,n._)("h2",null,"ROB",-1))),b=["value"],w=u((()=>(0,n._)("h2",null,"WC",-1))),f=["value"],y=u((()=>(0,n._)("h2",null,"Parties communes",-1))),x=["value"],V=u((()=>(0,n._)("div",{style:{"font-size":"19px",color:"white","font-weight":"bold"}},"VISITE HEBDOMADAIRE",-1))),I={style:{"font-size":"14px",color:"white","font-weight":"bold","margin-bottom":"20px"}},D={class:"form_bloc"},H=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Contrat",-1))),k={class:"form_bloc_content"},z={class:"col"},C=u((()=>(0,n._)("div",{class:"form_bloc_subtitle"},"Référence",-1))),F={class:"col"},U=u((()=>(0,n._)("br",null,null,-1))),E=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Code",-1))),q={class:"form_bloc_content"},S={class:"form_bloc_content table_container"},P=u((()=>(0,n._)("tr",null,[(0,n._)("th",null,"Nb Logt"),(0,n._)("th",null,"Nb Ch."),(0,n._)("th",null,"Nb WC comm."),(0,n._)("th",null,"Nb loc. comm.")],-1))),N={class:"form_bloc_content table_container"},A=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Gardien",-1))),L={class:"recur_table"},R=u((()=>(0,n._)("tr",null,[(0,n._)("th",null,"Nom"),(0,n._)("th",null,"Adresse loge"),(0,n._)("th",null,"Horaire")],-1))),O=u((()=>(0,n._)("tr",null,[(0,n._)("th",null,"Fixe"),(0,n._)("th",null,"Portable")],-1))),j={class:"form_bloc_content table_container"},W=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Syndic / Gérant",-1))),Y={class:"recur_table"},$=u((()=>(0,n._)("tr",null,[(0,n._)("th",null,"Nom"),(0,n._)("th",null,"Fixe")],-1))),B={class:"form_bloc_content table_container"},G=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Observations GERECO",-1))),K={class:"form_bloc_content"},Z={class:"form_bloc"},M=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Remarques (informations à modifier)",-1))),T={class:"form_bloc_content"},J={class:"form_bloc vg",style:{"margin-top":"40px"}},X=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Interventions",-1))),Q={class:"form_bloc_content table_container",style:{"margin-bottom":"40px"}},ee=u((()=>(0,n._)("tr",null,[(0,n._)("th",null,"Nom"),(0,n._)("th",null,"Bât."),(0,n._)("th",null,"Esc."),(0,n._)("th",null,"Et."),(0,n._)("th",null,"Pte"),(0,n._)("th",null,"Objet"),(0,n._)("th",null,"Modifier")],-1))),te=["onUpdate:modelValue","onInput"],ae=["onUpdate:modelValue","onInput"],ne=["onUpdate:modelValue","onInput"],ie=["onUpdate:modelValue","onInput"],le=["onUpdate:modelValue","onInput"],re=["onUpdate:modelValue","onInput"],se={style:{"text-align":"center"}},oe=["onClick"],_e=u((()=>(0,n._)("label",{style:{"font-weight":"bold"}},"Visa Gardien ou Représentant",-1))),ue={style:{"margin-bottom":"40px"}},de=u((()=>(0,n._)("input",{style:{},class:"input_button",type:"submit",value:"FINALISER LA VISITE"},null,-1)));function pe(e,t,a,i,l,o){const _=(0,n.up)("router-link"),u=(0,n.up)("VueSignaturePad");return(0,n.wg)(),(0,n.iD)("form",{onSubmit:t[8]||(t[8]=(0,r.iM)(((...e)=>o.submitForm&&o.submitForm(...e)),["prevent"]))},[(0,n._)("div",d,[(0,n._)("div",p,[m,c,(0,n._)("div",{style:{background:"white",padding:"2px",border:"1px solid black",position:"absolute",right:"20px",top:"20px"},onClick:t[0]||(t[0]=e=>l.isShowPresta=!0)},"Prestations"),(0,n._)("div",{style:{"padding-bottom":"20px",width:"100%",height:"600px","overflow-y":"scroll",background:"white",position:"absolute",top:"0px"},class:(0,s.C_)({invis:!l.isShowPresta})},[h,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.inter_option["presta_fam1"],(e=>((0,n.wg)(),(0,n.iD)("div",{key:e,value:e.id},(0,s.zw)(e.libelle),9,v)))),128)),g,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.inter_option["presta_fam3"],(e=>((0,n.wg)(),(0,n.iD)("div",{key:e,value:e.id},(0,s.zw)(e.libelle),9,b)))),128)),w,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.inter_option["presta_fam4"],(e=>((0,n.wg)(),(0,n.iD)("div",{key:e,value:e.id},(0,s.zw)(e.libelle),9,f)))),128)),y,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.inter_option["presta_fam5"],(e=>((0,n.wg)(),(0,n.iD)("div",{key:e,value:e.id},(0,s.zw)(e.libelle),9,x)))),128)),(0,n._)("div",{style:{background:"white",padding:"2px","font-size":"25px",position:"absolute",top:"25px",right:"25px"},onClick:t[1]||(t[1]=e=>l.isShowPresta=!1)},"X")],2)]),V,(0,n._)("div",I,(0,s.zw)(l.resp.Evt_dtDebut),1),(0,n._)("div",D,[H,(0,n._)("div",k,[(0,n._)("div",z,[C,(0,n._)("div",null,(0,s.zw)(l.resp.Evt_reference),1)]),(0,n._)("div",F,[(0,n.Uk)((0,s.zw)(l.resp.Imm_1_adr),1),U,(0,n.Uk)(" "+(0,s.zw)(l.resp.Imm_2_adr),1)])]),E,(0,n._)("div",q,[(0,n._)("div",null,(0,s.zw)(l.resp.gardien_code),1)]),(0,n._)("div",S,[(0,n._)("div",null,[(0,n._)("table",null,[P,(0,n._)("tr",null,[(0,n._)("td",null,(0,s.zw)(l.resp.Imm_nbLog),1),(0,n._)("td",null,(0,s.zw)(l.resp.Imm_nbCham),1),(0,n._)("td",null,(0,s.zw)(l.resp.Imm_nbWC),1),(0,n._)("td",null,(0,s.zw)(l.resp.nbLocComm),1)])])])]),(0,n._)("div",N,[A,(0,n._)("div",L,[(0,n._)("table",null,[R,(0,n._)("tr",null,[(0,n._)("td",null,(0,s.zw)(l.resp.gardien_nom),1),(0,n._)("td",null,(0,s.zw)(l.resp.gardien_adresse),1),(0,n._)("td",null,(0,s.zw)(l.resp.gardien_HeuresLoge),1)])]),(0,n._)("table",null,[O,(0,n._)("tr",null,[(0,n._)("td",null,(0,s.zw)(l.resp.gardien_telephone),1),(0,n._)("td",null,(0,s.zw)(l.resp.gardien_mobile),1)])])]),(0,n._)("div",j,[W,(0,n._)("div",Y,[(0,n._)("table",null,[$,(0,n._)("tr",null,[(0,n._)("td",null,(0,s.zw)(l.resp.client_raisonSoc),1),(0,n._)("td",null,(0,s.zw)(l.resp.client_tel1),1)])])])]),(0,n._)("div",B,[G,(0,n._)("div",K,[(0,n.wy)((0,n._)("textarea",{disabled:"","onUpdate:modelValue":t[2]||(t[2]=e=>l.resp.VH_remarquePreliminaire=e),onInput:t[3]||(t[3]=t=>o.saveFormData(e.index)),style:{height:"70px"}},null,544),[[r.nr,l.resp.VH_remarquePreliminaire]])])]),(0,n._)("div",Z,[M,(0,n._)("div",T,[(0,n.wy)((0,n._)("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>this.remarque=e),onInput:t[5]||(t[5]=t=>o.saveFormData(e.index))},null,544),[[r.nr,this.remarque]])])])])])]),(0,n._)("div",J,[X,(0,n._)("div",Q,[(0,n._)("div",null,[(0,n._)("div",{onClick:t[6]||(t[6]=(...e)=>o.addItemAppartements&&o.addItemAppartements(...e)),class:"line_adder",style:{"margin-bottom":"10px"}},"+"),(0,n._)("table",null,[ee,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.appartements,((e,t)=>((0,n.wg)(),(0,n.iD)("tr",{key:t},[(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"40px"},type:"text","onUpdate:modelValue":t=>e.nom=t,onInput:e=>o.saveFormData(t)},null,40,te),[[r.nr,e.nom]])]),(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"15px"},type:"text","onUpdate:modelValue":t=>e.bat=t,onInput:e=>o.saveFormData(t)},null,40,ae),[[r.nr,e.bat]])]),(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"15px"},type:"text","onUpdate:modelValue":t=>e.escalier=t,onInput:e=>o.saveFormData(t)},null,40,ne),[[r.nr,e.escalier]])]),(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"15px"},type:"text","onUpdate:modelValue":t=>e.etage=t,onInput:e=>o.saveFormData(t)},null,40,ie),[[r.nr,e.etage]])]),(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"15px"},type:"text","onUpdate:modelValue":t=>e.porte=t,onInput:e=>o.saveFormData(t)},null,40,le),[[r.nr,e.porte]])]),(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"40px"},type:"text","onUpdate:modelValue":t=>e.objet=t,onInput:e=>o.saveFormData(t)},null,40,re),[[r.nr,e.objet]])]),(0,n._)("td",se,[this.vh_id?((0,n.wg)(),(0,n.j4)(_,{key:0,to:{name:"VHInter",params:{id:l.vh_id},query:{vhocc:t+1}}},{default:(0,n.w5)((()=>[(0,n.Uk)("--\x3e")])),_:2},1032,["to"])):(0,n.kq)("",!0)]),(0,n._)("div",{onClick:e=>o.removeLine(t),class:"line_remover"}," x ",8,oe)])))),128))])])]),_e,(0,n._)("div",ue,[(0,n.Wm)(u,{onChange:o.save,height:"200px",class:"signaturePad",ref:"signaturePad",options:{onBegin:e.onBegin,onEnd:o.onEnd}},null,8,["onChange","options"]),(0,n._)("div",null,[(0,n._)("div",{onClick:t[7]||(t[7]=(...e)=>o.undo&&o.undo(...e))},"Effacer")])])]),de],32)}a(541),a(7658);var me=a(8736),ce=a(5633),he={name:"VH",data(){return{isShowGreen:!0,isShowPresta:!1,currIp:this.currIp,resp:"",vh_id:"",remarque:"",signature:{image:"",data_arr:{}},inter_option:[],appartements:[{num:"",bat:"",nom:"",escalier:"",etage:"",porte:"",objet:"",signature:{image:"",data_arr:{}},temps_passe:"0",remarque_inter:"",statut:"Clôturé",checkbox_devis:!1,remarque:"",inter:[{inter_type:"",inter_lieu:"",inter_presta:"",inter_qty:"1"}],verif_ra:!1,verif_rob:!1,verif_wc:!1,verif_gen:!1}]}},async mounted(){let e=window.location.href.split("?"),t=e[1].split("&"),a={},n="";t.forEach((function(e){n=e.split("="),2==n.length&&(a[n[0]]=n[1])}));let i=a["item_id"];this.vh_id=i;let l=await(0,me.U2)("VH-"+this.vh_id);void 0!==l&&void 0!==l["signature"]["data_arr"]&&Object.keys(l["signature"]["data_arr"]).length>0&&this.$refs.signaturePad.fromData(l["signature"]["data_arr"]),ce.Z.get(this.currIp+"/mission_vh?item_id="+i).then((e=>{this.resp=e.data,ce.Z.get(this.currIp+"/get_contrat_presta?ctr_id="+this.resp.Ctr_code).then((e=>{this.inter_option=e.data,this.getFormData()}))})),this.getFormData(),window.addEventListener("beforeunload",this.saveFormData)},beforeUnmount(){window.removeEventListener("beforeunload",this.saveFormData)},methods:{undo(){this.$refs.signaturePad.clearSignature(),this.save()},save(){const{data:e}=this.$refs.signaturePad.saveSignature();var t="";e&&(t=e.replace("data:","").replace(/^.+,/,""));const a=this.$refs.signaturePad.toData();this.signature.image=t,this.signature.data_arr=a,this.saveFormData()},onEnd(){this.save()},async saveFormData(e){e+=1;var t=this.$data,a=JSON.stringify(t);if(a=JSON.parse(a),isNaN(e)){let e=1;while(await(0,me.U2)("VH-"+this.vh_id+"-"+e))void 0===a.appartements[e-1]&&await(0,me.IV)("VH-"+this.vh_id+"-"+e),e+=1;e=1;while(a.appartements[e-1])await(0,me.t8)("VH-"+this.vh_id+"-"+e,a.appartements[e-1]),e+=1}else await(0,me.t8)("VH-"+this.vh_id+"-"+e,a.appartements[e-1]);await(0,me.t8)("VH-"+this.vh_id,a)},async getFormData(){let e=1,t=[];if(void 0!==await(0,me.U2)("VH-"+this.vh_id+"-"+e)){while(void 0!==await(0,me.U2)("VH-"+this.vh_id+"-"+e)){let a=await(0,me.U2)("VH-"+this.vh_id+"-"+e);t[e-1]=a,e+=1}this.appartements=t}if(void 0!==await(0,me.U2)("VH-"+this.vh_id)){let e=await(0,me.U2)("VH-"+this.vh_id);this.remarque=e.remarque,this.compte_rendu=e.compte_rendu,this.signature=e.signature,this.temps_passe=e.temps_passe}this.saveFormData()},removeLine(e){confirm("Voulez-vous supprimer cette ligne ?")&&(this.appartements.splice(e,1),this.saveFormData())},addItemAppartements(){var e=this.appartements[0],t=e.num;this.appartements.unshift({num:Number(t)+1,bat:e.bat,nom:"",escalier:e.escalier,etage:e.etage,porte:"",suivi:"",signature:{image:"",data_arr:{}},remarque_inter:"",statut:"Clôturé",remarque:"",inter:[{inter_type:"",inter_lieu:"",inter_presta:"",inter_qty:"1"}],temps_passe:"0",verif_ra:!1,verif_rob:!1,verif_wc:!1,verif_gen:!1}),this.saveFormData()},submitForm(){const e={appartements:this.appartements,temps_passe:this.temps_passe,compte_rendu:this.compte_rendu,vh_id:this.vh_id,ctr_code:this.resp.Ctr_code,ctr_nature:this.resp.Ctr_nature,remarque:this.remarque,signature:this.signature};console.log(e),confirm("FINALISER LA VISITE. Vous allez envoyer les données au siège, vous ne pourrez plus accéder à cette VH.")&&ce.Z.post(this.currIp+"/submit_vh",e).then((e=>{console.log(e.data),200==e.status&&this.$router.push("/")}))}}},ve=a(5312);const ge=(0,ve.Z)(he,[["render",pe],["__scopeId","data-v-58c89ef9"]]);var be=ge,we={name:"VHView",components:{VH:be}};const fe=(0,ve.Z)(we,[["render",l]]);var ye=fe},3630:function(e,t,a){e.exports=a.p+"img/fleche2_blanc.dac177de.svg"},2957:function(e,t,a){e.exports=a.p+"img/logo-gereco-2.012b9603.svg"}}]);
//# sourceMappingURL=670.a13892c1.js.map