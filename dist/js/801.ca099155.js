"use strict";(self["webpackChunkwpa_gereco"]=self["webpackChunkwpa_gereco"]||[]).push([[801],{3801:function(e,t,a){a.r(t),a.d(t,{default:function(){return je}});var o=a(3396);const n={class:"IDBTest"};function i(e,t,a,i,s,r){const l=(0,o.up)("IDBTest");return(0,o.wg)(),(0,o.iD)("div",n,[(0,o.Wm)(l,{msg:"Welcome to Your Vue.js App"})])}var s=a(9242),r=a(7139),l=a(3630),u=a(2957);const d=e=>((0,o.dD)("data-v-2ee237d7"),e=e(),(0,o.Cn)(),e),p={class:"form_header"},_=(0,o.uE)('<div class="header_headline" data-v-2ee237d7><a href="/" data-v-2ee237d7><img class="return_button" src="'+l+'" data-v-2ee237d7></a><img src="'+u+'" data-v-2ee237d7></div><div style="font-size:19px;color:white;font-weight:bold;" data-v-2ee237d7>VISITE GÉNÉRALE</div>',2),m={style:{"font-size":"14px",color:"white","font-weight":"bold","margin-bottom":"20px"}},v={class:"form_bloc"},c=d((()=>(0,o._)("div",{class:"form_bloc_title"},"Contrat",-1))),h={class:"form_bloc_content"},g={class:"col"},b=d((()=>(0,o._)("div",{class:"form_bloc_subtitle"},"Référence",-1))),w={key:0},f={class:"col"},y=d((()=>(0,o._)("br",null,null,-1))),I=d((()=>(0,o._)("div",{class:"form_bloc_title"},"Code",-1))),x={class:"form_bloc_content"},C={class:"form_bloc_content table_container"},V=d((()=>(0,o._)("tr",null,[(0,o._)("th",null,"Nb Logt"),(0,o._)("th",null,"Nb Ch."),(0,o._)("th",null,"Nb WC comm."),(0,o._)("th",null,"Nb loc. comm.")],-1))),D={class:"form_bloc_content table_container"},U=d((()=>(0,o._)("div",{class:"form_bloc_title"},"Gardien",-1))),F={class:"recur_table"},j=d((()=>(0,o._)("tr",null,[(0,o._)("th",null,"Nom"),(0,o._)("th",null,"Adresse loge"),(0,o._)("th",null,"Horaire")],-1))),k=d((()=>(0,o._)("tr",null,[(0,o._)("th",null,"Fixe"),(0,o._)("th",null,"Portable")],-1))),E={class:"form_bloc_content table_container"},G=d((()=>(0,o._)("div",{class:"form_bloc_title"},"Syndic / Gérant",-1))),z={class:"recur_table"},q=d((()=>(0,o._)("tr",null,[(0,o._)("th",null,"Nom"),(0,o._)("th",null,"Fixe")],-1))),A={class:"form_bloc_content table_container"},S=d((()=>(0,o._)("div",{class:"form_bloc_title"},"Observations GERECO",-1))),N={class:"form_bloc_content"},L={class:"form_bloc"},R=d((()=>(0,o._)("div",{class:"form_bloc_title"},"Remarques (informations à modifier)",-1))),T={class:"form_bloc_content"},O={class:"form_bloc vg",style:{"margin-top":"40px"}},P={class:"form_bloc_title"},B={class:"form_bloc_content table_container"},Z=d((()=>(0,o._)("tr",null,[(0,o._)("th",null,"N°"),(0,o._)("th",null,"Bât."),(0,o._)("th",null,"Esc."),(0,o._)("th",null,"Et."),(0,o._)("th",null,"Pte"),(0,o._)("th",null,"Suivi"),(0,o._)("th",null,"Modif")],-1))),M=["onUpdate:modelValue","onInput"],$=["onUpdate:modelValue","onInput"],H=["onUpdate:modelValue","onInput"],W=["onUpdate:modelValue","onInput"],Y=["onUpdate:modelValue","onChange"],J=(0,o.uE)('<option value="Occupant" data-v-2ee237d7>Occupant</option><option value="Abs." data-v-2ee237d7>Abs.</option><option value="Abs. x2" data-v-2ee237d7>Abs. x2</option><option value="Gardien" data-v-2ee237d7>Gardien</option><option value="CLE" data-v-2ee237d7>CLE</option><option value="RO" data-v-2ee237d7>RO</option><option value="Avisé" data-v-2ee237d7>Avisé</option>',7),K=[J],Q={style:{"text-align":"center"}},X=["onClick"],ee={class:"form_bloc compteurs",style:{"margin-top":"40px"}},te=d((()=>(0,o._)("div",{class:"form_bloc_title"},"Compteurs",-1))),ae={class:"form_bloc_content table_container"},oe={class:"liste_vg"},ne=d((()=>(0,o._)("tr",null,[(0,o._)("th",null,"Num"),(0,o._)("th",null,"Type"),(0,o._)("th",null,"Date"),(0,o._)("th",null,"Loc."),(0,o._)("th",null,"Index")],-1))),ie=["onUpdate:modelValue","onInput"],se=["onUpdate:modelValue","onInput"],re=["onUpdate:modelValue","onInput"],le=["onUpdate:modelValue","onInput"],ue=["onUpdate:modelValue","onInput","disabled"],de=["onClick"],pe={class:"form_bloc",style:{"margin-top":"40px"}},_e=d((()=>(0,o._)("label",{style:{"font-weight":"bold"}},"Compte-rendu: ",-1))),me=d((()=>(0,o._)("br",null,null,-1))),ve={style:{"margin-bottom":"20px"}},ce=d((()=>(0,o._)("label",null,"Temps passé (hors déplacement)* :",-1))),he=(0,o.uE)('<option value="0.25" data-v-2ee237d7>2 heures</option><option value="0.5" data-v-2ee237d7>0,5 jour</option><option value="1" data-v-2ee237d7>1 jour</option><option value="1.5" data-v-2ee237d7>1,5 jour</option><option value="2" data-v-2ee237d7>2 jours</option><option value="2.5" data-v-2ee237d7>2,5 jours</option><option value="3" data-v-2ee237d7>3 jours</option><option value="3.5" data-v-2ee237d7>3,5 jours</option><option value="4" data-v-2ee237d7>4 jours</option><option value="4.5" data-v-2ee237d7>4,5 jours</option><option value="5" data-v-2ee237d7>5 jours</option><option value="5.5" data-v-2ee237d7>5,5 jours</option><option value="6" data-v-2ee237d7>6 jours</option><option value="6.5" data-v-2ee237d7>6,5 jours</option><option value="7" data-v-2ee237d7>7 jours</option><option value="7.5" data-v-2ee237d7>7,5 jours</option><option value="8" data-v-2ee237d7>8 jours</option><option value="8.5" data-v-2ee237d7>8,5 jours</option><option value="9" data-v-2ee237d7>9 jours</option><option value="9.5" data-v-2ee237d7>9,5 jours</option><option value="10" data-v-2ee237d7>10 jours</option><option value="11" data-v-2ee237d7>11 jours</option><option value="12" data-v-2ee237d7>12 jours</option><option value="13" data-v-2ee237d7>13 jours</option><option value="14" data-v-2ee237d7>14 jours</option><option value="15" data-v-2ee237d7>15 jours</option><option value="16" data-v-2ee237d7>16 jours</option><option value="17" data-v-2ee237d7>17 jours</option><option value="18" data-v-2ee237d7>18 jours</option><option value="19" data-v-2ee237d7>19 jours</option><option value="20" data-v-2ee237d7>20 jours</option>',31),ge=[he],be=d((()=>(0,o._)("label",{style:{}},"Visa Gardien ou Représentant",-1))),we=d((()=>(0,o._)("input",{class:"input_button",type:"submit",value:"FINALISER LA VISITE",style:{"margin-top":"20px"}},null,-1)));function fe(e,t,a,n,i,l){const u=(0,o.up)("router-link"),d=(0,o.up)("VueSignaturePad");return(0,o.wg)(),(0,o.iD)("form",{onSubmit:t[13]||(t[13]=(0,s.iM)(((...e)=>l.submitForm&&l.submitForm(...e)),["prevent"]))},[(0,o._)("div",p,[_,(0,o._)("div",m,(0,r.zw)(i.resp.Evt_dtDebut),1),(0,o._)("div",v,[c,(0,o._)("div",h,[(0,o._)("div",g,[b,(0,o._)("div",null,[(0,o.Uk)((0,r.zw)(i.resp.Evt_reference),1),"P"==i.resp.Ctr_nature||"B"==i.resp.Ctr_nature?((0,o.wg)(),(0,o.iD)("span",w," - Cubage")):(0,o.kq)("",!0)])]),(0,o._)("div",f,[(0,o.Uk)((0,r.zw)(i.resp.Imm_1_adr),1),y,(0,o.Uk)(" "+(0,r.zw)(i.resp.Imm_2_adr),1)])]),I,(0,o._)("div",x,[(0,o._)("div",null,(0,r.zw)(i.resp.gardien_code),1)]),(0,o._)("div",C,[(0,o._)("div",null,[(0,o._)("table",null,[V,(0,o._)("tr",null,[(0,o._)("td",null,(0,r.zw)(i.resp.Imm_nbLog),1),(0,o._)("td",null,(0,r.zw)(i.resp.Imm_nbCham),1),(0,o._)("td",null,(0,r.zw)(i.resp.Imm_nbWC),1),(0,o._)("td",null,(0,r.zw)(i.resp.Imm_nbLocComm),1)])])])]),(0,o._)("div",D,[U,(0,o._)("div",F,[(0,o._)("table",null,[j,(0,o._)("tr",null,[(0,o._)("td",null,(0,r.zw)(i.resp.gardien_nom),1),(0,o._)("td",null,(0,r.zw)(i.resp.gardien_adresse),1),(0,o._)("td",null,(0,r.zw)(i.resp.gardien_HeuresLoge),1)])]),(0,o._)("table",null,[k,(0,o._)("tr",null,[(0,o._)("td",null,(0,r.zw)(i.resp.gardien_telephone),1),(0,o._)("td",null,(0,r.zw)(i.resp.gardien_mobile),1)])])]),(0,o._)("div",E,[G,(0,o._)("div",z,[(0,o._)("table",null,[q,(0,o._)("tr",null,[(0,o._)("td",null,(0,r.zw)(i.resp.client_raisonSoc),1),(0,o._)("td",null,(0,r.zw)(i.resp.client_tel1),1)])])])]),(0,o._)("div",A,[S,(0,o._)("div",N,[(0,o.wy)((0,o._)("textarea",{disabled:"","onUpdate:modelValue":t[0]||(t[0]=e=>i.resp.VG_remarqueTech=e),onInput:t[1]||(t[1]=t=>l.saveFormData(e.index)),style:{height:"70px"}},null,544),[[s.nr,i.resp.VG_remarqueTech]])])]),(0,o._)("div",L,[R,(0,o._)("div",T,[(0,o.wy)((0,o._)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>i.remarque=e),onInput:t[3]||(t[3]=t=>l.saveFormData(e.index))},null,544),[[s.nr,i.remarque]])])])])])]),(0,o._)("div",O,[(0,o._)("div",P,[(0,o.Uk)("Appartements "),(0,o._)("div",{class:"filter_button",onClick:t[4]||(t[4]=e=>i.isShowGreen=!i.isShowGreen)},"Filtrer")]),(0,o._)("div",B,[(0,o._)("div",null,[(0,o._)("table",null,[Z,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.appartements,((e,t)=>((0,o.wg)(),(0,o.iD)("tr",{key:t,class:(0,r.C_)({green:"Abs."!=e.suivi&&""!=e.suivi,invis:"Abs."!=e.suivi&&""!=e.suivi&&!i.isShowGreen})},[(0,o._)("td",null,(0,r.zw)(e.num),1),(0,o._)("td",null,[(0,o.wy)((0,o._)("input",{style:{width:"25px"},type:"text","onUpdate:modelValue":t=>e.bat=t,onInput:e=>l.saveFormData(t)},null,40,M),[[s.nr,e.bat]])]),(0,o._)("td",null,[(0,o.wy)((0,o._)("input",{style:{width:"25px"},type:"text","onUpdate:modelValue":t=>e.escalier=t,onInput:e=>l.saveFormData(t)},null,40,$),[[s.nr,e.escalier]])]),(0,o._)("td",null,[(0,o.wy)((0,o._)("input",{style:{width:"25px"},type:"text","onUpdate:modelValue":t=>e.etage=t,onInput:e=>l.saveFormData(t)},null,40,H),[[s.nr,e.etage]])]),(0,o._)("td",null,[(0,o.wy)((0,o._)("input",{style:{width:"25px"},type:"text","onUpdate:modelValue":t=>e.porte=t,onInput:e=>l.saveFormData(t)},null,40,W),[[s.nr,e.porte]])]),(0,o._)("td",null,[(0,o.wy)((0,o._)("select",{"onUpdate:modelValue":t=>e.suivi=t,onChange:e=>l.saveFormData(t),id:"suivi"},K,40,Y),[[s.bM,e.suivi]])]),(0,o._)("td",Q,[this.vg_id&&"Abs."!=e.suivi&&"Abs. x2"!=e.suivi&&"RO"!=e.suivi&&"Avisé"!=e.suivi?((0,o.wg)(),(0,o.j4)(u,{key:0,to:{name:"VGInter",params:{id:i.vg_id},query:{vgocc:t+1}}},{default:(0,o.w5)((()=>[(0,o.Uk)("--\x3e")])),_:2},1032,["to"])):(0,o.kq)("",!0)]),(0,o._)("div",{onClick:e=>l.removeLine(t),class:"line_remover"}," x ",8,X)],2)))),128))]),(0,o._)("div",{onClick:t[5]||(t[5]=(...e)=>l.addItemAppartements&&l.addItemAppartements(...e)),class:"line_adder"},"+")])])]),(0,o._)("div",{class:"save_button",style:{"margin-top":"20px"},onClick:t[6]||(t[6]=(...e)=>l.enregistrer&&l.enregistrer(...e))},"ENREGISTRER"),(0,o._)("div",null,"Dernier enregistrement : "+(0,r.zw)(i.date_enregistrement),1),(0,o._)("div",ee,[te,(0,o._)("div",ae,[(0,o._)("div",null,[(0,o._)("table",oe,[ne,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.compteurs,((t,a)=>((0,o.wg)(),(0,o.iD)("tr",{key:a,class:"vg-line"},[(0,o._)("td",null,[(0,o.wy)((0,o._)("input",{style:{width:"70px"},type:"text","onUpdate:modelValue":e=>t.numero=e,onInput:e=>l.saveFormData(a)},null,40,ie),[[s.nr,t.numero]])]),(0,o._)("td",null,[(0,o.wy)((0,o._)("input",{style:{width:"28px"},type:"text","onUpdate:modelValue":e=>t.type=e,onInput:e=>l.saveFormData(a)},null,40,se),[[s.nr,t.type]])]),(0,o._)("td",null,[(0,o.wy)((0,o._)("input",{style:{width:"60px"},type:"date","onUpdate:modelValue":e=>t.date=e,onInput:e=>l.saveFormData(a)},null,40,re),[[s.nr,t.date]])]),(0,o._)("td",null,[(0,o.wy)((0,o._)("textarea",{style:{width:"40px"},"onUpdate:modelValue":e=>t.localisation=e,onInput:e=>l.saveFormData(a)},null,40,le),[[s.nr,t.localisation]])]),(0,o._)("td",null,[(0,o.wy)((0,o._)("input",{style:{width:"34px"},type:"text","onUpdate:modelValue":e=>t.index=e,onInput:e=>l.saveFormData(a),disabled:""!=t.date?e.disabled:""},null,40,ue),[[s.nr,t.index]])]),(0,o._)("div",{onClick:e=>l.removeCompteur(a),class:"line_remover"}," x ",8,de)])))),128))]),(0,o._)("div",{onClick:t[7]||(t[7]=(...e)=>l.addItemCompteurs&&l.addItemCompteurs(...e)),class:"line_adder"},"+")])])]),(0,o._)("div",pe,[(0,o._)("p",null,[_e,me,(0,o.wy)((0,o._)("textarea",{"onUpdate:modelValue":t[8]||(t[8]=e=>this.compte_rendu=e),onInput:t[9]||(t[9]=t=>l.saveFormData(e.index))},null,544),[[s.nr,this.compte_rendu]])]),(0,o._)("div",ve,[ce,(0,o.wy)((0,o._)("select",{"onUpdate:modelValue":t[10]||(t[10]=e=>this.temps_passe=e),onChange:t[11]||(t[11]=t=>l.saveFormData(e.index)),required:""},ge,544),[[s.bM,this.temps_passe]])]),be,(0,o._)("div",null,[(0,o.Wm)(d,{onChange:l.save,height:"200px",class:"signaturePad",ref:"signaturePad",options:{onBegin:e.onBegin,onEnd:l.onEnd}},null,8,["onChange","options"]),(0,o._)("div",null,[(0,o._)("div",{onClick:t[12]||(t[12]=(...e)=>l.undo&&l.undo(...e))},"Effacer")])])]),we],32)}a(7658);var ye=a(9262),Ie=a(4161),xe={name:"IDBTest",data(){return{isShowGreen:!0,currIp:this.currIp,resp:"",vg_id:"",tech_id:"",date_enregistrement:"",compte_rendu:"",remarque:"",temps_passe:"",signature:{image:"",data_arr:{}},inter_option:[],compteurs:[],appartements:[{num:"",bat:"",nom:"",escalier:"",etage:"",porte:"",suivi:"",signature:{image:"",data_arr:{}},remarque_inter:"",statut:"Clôturé",checkbox_devis:!1,remarque:"",inter:[{inter_type:"",inter_lieu:"",inter_presta:"",inter_qty:"1"}],verif_ra:!1,verif_rob:!1,verif_wc:!1,verif_gen:!1}]}},async mounted(){let e=window.location.href.split("?"),t=e[1].split("&"),a={},o="";t.forEach((function(e){o=e.split("="),2==o.length&&(a[o[0]]=o[1])}));let n=a["item_id"];this.vg_id=n;let i=await(0,ye.U2)("VG-"+this.vg_id),s=await(0,ye.U2)("current_tech");this.tech_id=s,void 0!==i&&void 0!==i["signature"]["data_arr"]&&Object.keys(i["signature"]["data_arr"]).length>0&&this.$refs.signaturePad.fromData(i["signature"]["data_arr"]),Ie.Z.get(this.currIp+"/mission_vg?item_id="+n).then((e=>{this.resp=e.data,Ie.Z.get(this.currIp+"/get_contrat_presta?ctr_id="+this.resp.Ctr_code).then((e=>{this.inter_option=e.data,this.getFormData()})),Ie.Z.get(this.currIp+"/get_compteurs?ctr_id="+this.resp.Ctr_code).then((e=>{let t=!1;for(let a of e.data){if(i){let e=i["compteurs"];if(0!=e.length)for(let o of e)o["id"]==a.Cpt_id&&(t=o)}0==!t?this.compteurs.push({id:t["id"],numero:t["numero"],type:t["type"],date:t["date"],index:t["index"],localisation:t["localisation"],new:!1}):this.compteurs.push({id:a.Cpt_id,numero:a.Cpt_numero,type:a.Cpt_nature,date:"",index:"",localisation:a.Cpt_localisation,new:!1})}this.getFormData()}))})),window.addEventListener("beforeunload",this.saveFormData)},beforeUnmount(){window.removeEventListener("beforeunload",this.saveFormData)},methods:{undo(){this.$refs.signaturePad.undoSignature(),this.save()},save(){const{data:e}=this.$refs.signaturePad.saveSignature();var t="";e&&(t=e.replace("data:","").replace(/^.+,/,""));const a=this.$refs.signaturePad.toData();this.signature.image=t,this.signature.data_arr=a,this.saveFormData()},onEnd(){this.save()},async saveFormData(e){e+=1;var t=this.$data,a=JSON.stringify(t);if(a=JSON.parse(a),isNaN(e)){let e=1;while(await(0,ye.U2)("VG-"+this.vg_id+"-"+e))void 0===a.appartements[e-1]&&await(0,ye.IV)("VG-"+this.vg_id+"-"+e),e+=1;e=1;while(a.appartements[e-1])await(0,ye.t8)("VG-"+this.vg_id+"-"+e,a.appartements[e-1]),e+=1}else await(0,ye.t8)("VG-"+this.vg_id+"-"+e,a.appartements[e-1]);await(0,ye.t8)("VG-"+this.vg_id,a)},async getFormData(){let e=1,t=[];if(void 0!==await(0,ye.U2)("VG-"+this.vg_id+"-"+e)){while(void 0!==await(0,ye.U2)("VG-"+this.vg_id+"-"+e)){let a=await(0,ye.U2)("VG-"+this.vg_id+"-"+e);t[e-1]=a,e+=1}this.appartements=t}if(void 0!==await(0,ye.U2)("VG-"+this.vg_id)){let e=await(0,ye.U2)("VG-"+this.vg_id);this.compte_rendu=e.compte_rendu,this.compteurs=e.compteurs,this.signature=e.signature,this.temps_passe=e.temps_passe,this.date_enregistrement=e.date_enregistrement,this.remarque=e.remarque}this.saveFormData()},addItemAppartements(){var e=this.appartements[this.appartements.length-1],t=e.num;this.appartements.push({num:Number(t)+1,bat:e.bat,nom:"",escalier:e.escalier,etage:e.etage,porte:"",suivi:"",signature:{image:"",data_arr:{}},remarque_inter:"",statut:"Clôturé",checkbox_devis:!1,remarque:"",inter:[{inter_type:"",inter_lieu:"",inter_presta:"",inter_qty:"1"}],verif_ra:!1,verif_rob:!1,verif_wc:!1,verif_gen:!1}),this.saveFormData()},addItemCompteurs(){this.compteurs.push({numero:"",type:"",date:"",index:"",localisation:"",new:!0}),this.saveFormData()},removeItem(e,t){this["inter_"+t].splice(e,1),this.saveFormData()},removeLine(e){confirm("Voulez-vous supprimer cette ligne ?")&&(this.appartements.splice(e,1),this.saveFormData())},removeCompteur(e){confirm("Voulez-vous supprimer cette ligne ?")&&(this.compteurs.splice(e,1),this.saveFormData())},enregistrer(){const e={appartements:this.appartements,compteurs:[],compte_rendu:this.compte_rendu,vg_id:this.vg_id,remarque:this.remarque,ctr_code:this.resp.Ctr_code,ctr_nature:this.resp.Ctr_nature,signature:this.signature};console.log(e);var t=new Date,a=t.getDate(),o=t.getMonth()+1,n=t.getFullYear(),i=t.getHours(),s=t.getMinutes();a<10&&(a="0"+a),o<10&&(o="0"+o),s<10&&(s="0"+s),t=a+"-"+o+"-"+n+" "+i+":"+s,Ie.Z.post(this.currIp+"/submit_vg",e).then((e=>{console.log(e.data),200==e.status&&(this.date_enregistrement=t)}))},submitForm(){for(var e=0;e<this.compteurs.length;e++)if(""!==this.compteurs[e].date){var t=this.compteurs[e].date.match(/\d+/g),a=t[2]+"/"+t[1]+"/"+t[0];this.compteurs[e].date=a}const o={appartements:this.appartements,compteurs:this.compteurs,temps_passe:this.temps_passe,compte_rendu:this.compte_rendu,vg_id:this.vg_id,remarque:this.remarque,ctr_code:this.resp.Ctr_code,ctr_nature:this.resp.Ctr_nature,signature:this.signature,tech_id:this.tech_id};console.log(o),confirm("FINALISER LA VISITE. Vous allez envoyer les données au siège, vous ne pourrez plus accéder à cette VG.")&&Ie.Z.post(this.currIp+"/submit_vg",o).then((e=>{console.log(e.data),200==e.status&&this.$router.push("/")}))}}},Ce=a(89);const Ve=(0,Ce.Z)(xe,[["render",fe],["__scopeId","data-v-2ee237d7"]]);var De=Ve,Ue={name:"IDBTestView",components:{IDBTest:De}};const Fe=(0,Ce.Z)(Ue,[["render",i]]);var je=Fe},3630:function(e,t,a){e.exports=a.p+"img/fleche2_blanc.dac177de.svg"},2957:function(e,t,a){e.exports=a.p+"img/logo-gereco-2.012b9603.svg"}}]);
//# sourceMappingURL=801.ca099155.js.map