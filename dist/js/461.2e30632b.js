"use strict";(self["webpackChunkwpa_gereco"]=self["webpackChunkwpa_gereco"]||[]).push([[461],{5461:function(t,e,a){a.r(e),a.d(e,{default:function(){return ut}});var n=a(8473);const r={class:"VH"};function i(t,e,a,i,l,s){const o=(0,n.up)("VH");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n.Wm)(o,{msg:"Welcome to Your Vue.js App"})])}var l=a(9197),s=a(4887),o=a(3630),_=a(2957);const u=t=>((0,n.dD)("data-v-a43eb702"),t=t(),(0,n.Cn)(),t),d={class:"form_header"},p=(0,n.uE)('<div class="header_headline" data-v-a43eb702><a href="/" data-v-a43eb702><img class="return_button" src="'+o+'" data-v-a43eb702></a><img src="'+_+'" data-v-a43eb702></div><div style="font-size:19px;color:white;font-weight:bold;" data-v-a43eb702>VISITE HEBDOMADAIRE</div>',2),m={style:{"font-size":"14px",color:"white","font-weight":"bold","margin-bottom":"20px"}},c={class:"form_bloc"},h=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Contrat",-1))),v={class:"form_bloc_content"},b={class:"col"},g=u((()=>(0,n._)("div",{class:"form_bloc_subtitle"},"Référence",-1))),f={class:"col"},w=u((()=>(0,n._)("br",null,null,-1))),y=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Code",-1))),V={class:"form_bloc_content"},I={class:"form_bloc_content table_container"},x=u((()=>(0,n._)("tr",null,[(0,n._)("th",null,"Nb Logt"),(0,n._)("th",null,"Nb Ch."),(0,n._)("th",null,"Nb WC comm."),(0,n._)("th",null,"Nb loc. comm.")],-1))),D={class:"form_bloc_content table_container"},F=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Gardien",-1))),U={class:"recur_table"},H=u((()=>(0,n._)("tr",null,[(0,n._)("th",null,"Nom"),(0,n._)("th",null,"Adresse loge"),(0,n._)("th",null,"Horaire")],-1))),C=u((()=>(0,n._)("tr",null,[(0,n._)("th",null,"Fixe"),(0,n._)("th",null,"Portable")],-1))),z={class:"form_bloc_content table_container"},E=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Syndic / Gérant",-1))),q={class:"recur_table"},k=u((()=>(0,n._)("tr",null,[(0,n._)("th",null,"Nom"),(0,n._)("th",null,"Fixe")],-1))),N={class:"form_bloc_content table_container"},S=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Observations GERECO",-1))),L={class:"form_bloc_content"},A={class:"form_bloc"},P=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Remarques (informations à modifier)",-1))),j={class:"form_bloc_content"},O={class:"form_bloc vg",style:{"margin-top":"40px"}},R=u((()=>(0,n._)("div",{class:"form_bloc_title"},"Interventions",-1))),$={class:"form_bloc_content table_container",style:{"margin-bottom":"40px"}},G=u((()=>(0,n._)("tr",null,[(0,n._)("th",null,"Nom"),(0,n._)("th",null,"Bât."),(0,n._)("th",null,"Esc."),(0,n._)("th",null,"Et."),(0,n._)("th",null,"Pte"),(0,n._)("th",null,"Objet"),(0,n._)("th",null,"Modifier")],-1))),W=["onUpdate:modelValue","onInput"],Z=["onUpdate:modelValue","onInput"],B=["onUpdate:modelValue","onInput"],M=["onUpdate:modelValue","onInput"],T=["onUpdate:modelValue","onInput"],J=["onUpdate:modelValue","onInput"],Y={style:{"text-align":"center"}},K=["onClick"],Q=u((()=>(0,n._)("label",{style:{"font-weight":"bold"}},"Visa Gardien ou Représentant",-1))),X={style:{"margin-bottom":"40px"}},tt=u((()=>(0,n._)("input",{style:{},class:"input_button",type:"submit",value:"FINALISER LA VISITE"},null,-1)));function et(t,e,a,r,i,o){const _=(0,n.up)("router-link"),u=(0,n.up)("VueSignaturePad");return(0,n.wg)(),(0,n.iD)("form",{onSubmit:e[6]||(e[6]=(0,l.iM)(((...t)=>o.submitForm&&o.submitForm(...t)),["prevent"]))},[(0,n._)("div",d,[p,(0,n._)("div",m,(0,s.zw)(i.resp.Evt_dtDebut),1),(0,n._)("div",c,[h,(0,n._)("div",v,[(0,n._)("div",b,[g,(0,n._)("div",null,(0,s.zw)(i.resp.Evt_reference),1)]),(0,n._)("div",f,[(0,n.Uk)((0,s.zw)(i.resp.Imm_1_adr),1),w,(0,n.Uk)(" "+(0,s.zw)(i.resp.Imm_2_adr),1)])]),y,(0,n._)("div",V,[(0,n._)("div",null,(0,s.zw)(i.resp.gardien_code),1)]),(0,n._)("div",I,[(0,n._)("div",null,[(0,n._)("table",null,[x,(0,n._)("tr",null,[(0,n._)("td",null,(0,s.zw)(i.resp.Imm_nbLog),1),(0,n._)("td",null,(0,s.zw)(i.resp.Imm_nbCham),1),(0,n._)("td",null,(0,s.zw)(i.resp.Imm_nbWC),1),(0,n._)("td",null,(0,s.zw)(i.resp.nbLocComm),1)])])])]),(0,n._)("div",D,[F,(0,n._)("div",U,[(0,n._)("table",null,[H,(0,n._)("tr",null,[(0,n._)("td",null,(0,s.zw)(i.resp.gardien_nom),1),(0,n._)("td",null,(0,s.zw)(i.resp.gardien_adresse),1),(0,n._)("td",null,(0,s.zw)(i.resp.gardien_HeuresLoge),1)])]),(0,n._)("table",null,[C,(0,n._)("tr",null,[(0,n._)("td",null,(0,s.zw)(i.resp.gardien_telephone),1),(0,n._)("td",null,(0,s.zw)(i.resp.gardien_mobile),1)])])]),(0,n._)("div",z,[E,(0,n._)("div",q,[(0,n._)("table",null,[k,(0,n._)("tr",null,[(0,n._)("td",null,(0,s.zw)(i.resp.client_raisonSoc),1),(0,n._)("td",null,(0,s.zw)(i.resp.client_tel1),1)])])])]),(0,n._)("div",N,[S,(0,n._)("div",L,[(0,n.wy)((0,n._)("textarea",{disabled:"","onUpdate:modelValue":e[0]||(e[0]=t=>i.resp.VH_remarquePreliminaire=t),onInput:e[1]||(e[1]=e=>o.saveFormData(t.index)),style:{height:"70px"}},null,544),[[l.nr,i.resp.VH_remarquePreliminaire]])])]),(0,n._)("div",A,[P,(0,n._)("div",j,[(0,n.wy)((0,n._)("textarea",{"onUpdate:modelValue":e[2]||(e[2]=t=>this.remarque=t),onInput:e[3]||(e[3]=e=>o.saveFormData(t.index))},null,544),[[l.nr,this.remarque]])])])])])]),(0,n._)("div",O,[R,(0,n._)("div",$,[(0,n._)("div",null,[(0,n._)("table",null,[G,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.appartements,((t,e)=>((0,n.wg)(),(0,n.iD)("tr",{key:e},[(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"40px"},type:"text","onUpdate:modelValue":e=>t.nom=e,onInput:t=>o.saveFormData(e)},null,40,W),[[l.nr,t.nom]])]),(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"15px"},type:"text","onUpdate:modelValue":e=>t.bat=e,onInput:t=>o.saveFormData(e)},null,40,Z),[[l.nr,t.bat]])]),(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"15px"},type:"text","onUpdate:modelValue":e=>t.escalier=e,onInput:t=>o.saveFormData(e)},null,40,B),[[l.nr,t.escalier]])]),(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"15px"},type:"text","onUpdate:modelValue":e=>t.etage=e,onInput:t=>o.saveFormData(e)},null,40,M),[[l.nr,t.etage]])]),(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"15px"},type:"text","onUpdate:modelValue":e=>t.porte=e,onInput:t=>o.saveFormData(e)},null,40,T),[[l.nr,t.porte]])]),(0,n._)("td",null,[(0,n.wy)((0,n._)("input",{style:{width:"40px"},type:"text","onUpdate:modelValue":e=>t.objet=e,onInput:t=>o.saveFormData(e)},null,40,J),[[l.nr,t.objet]])]),(0,n._)("td",Y,[this.vh_id?((0,n.wg)(),(0,n.j4)(_,{key:0,to:{name:"VHInter",params:{id:i.vh_id},query:{vhocc:e+1}}},{default:(0,n.w5)((()=>[(0,n.Uk)("--\x3e")])),_:2},1032,["to"])):(0,n.kq)("",!0)]),(0,n._)("div",{onClick:t=>o.removeLine(e),class:"line_remover"}," x ",8,K)])))),128))]),(0,n._)("div",{onClick:e[4]||(e[4]=(...t)=>o.addItemAppartements&&o.addItemAppartements(...t)),class:"line_adder"},"+")])]),Q,(0,n._)("div",X,[(0,n.Wm)(u,{onChange:o.save,height:"200px",class:"signaturePad",ref:"signaturePad",options:{onBegin:t.onBegin,onEnd:o.onEnd}},null,8,["onChange","options"]),(0,n._)("div",null,[(0,n._)("div",{onClick:e[5]||(e[5]=(...t)=>o.undo&&o.undo(...t))},"Effacer")])])]),tt],32)}a(541),a(7658);var at=a(8736),nt=a(5633),rt={name:"VH",data(){return{isShowGreen:!0,currIp:this.currIp,resp:"",vh_id:"",remarque:"",signature:{image:"",data_arr:{}},inter_option:[],appartements:[{num:"",bat:"",nom:"",escalier:"",etage:"",porte:"",objet:"",signature:{image:"",data_arr:{}},temps_passe:"0",remarque_inter:"",statut:"Clôturé",checkbox_devis:!1,remarque:"",inter:[{inter_type:"",inter_lieu:"",inter_presta:"",inter_qty:"1"}],verif_ra:!1,verif_rob:!1,verif_wc:!1,verif_gen:!1}]}},async mounted(){let t=window.location.href.split("?"),e=t[1].split("&"),a={},n="";e.forEach((function(t){n=t.split("="),2==n.length&&(a[n[0]]=n[1])}));let r=a["item_id"];this.vh_id=r;let i=await(0,at.U2)("VH-"+this.vh_id);void 0!==i&&void 0!==i["signature"]["data_arr"]&&Object.keys(i["signature"]["data_arr"]).length>0&&this.$refs.signaturePad.fromData(i["signature"]["data_arr"]),nt.Z.get(this.currIp+"/mission_vh?item_id="+r).then((t=>{this.resp=t.data,nt.Z.get(this.currIp+"/get_contrat_presta?ctr_id="+this.resp.Ctr_code).then((t=>{this.inter_option=t.data,this.getFormData()}))})),this.getFormData(),window.addEventListener("beforeunload",this.saveFormData)},beforeUnmount(){window.removeEventListener("beforeunload",this.saveFormData)},methods:{undo(){this.$refs.signaturePad.clearSignature(),this.save()},save(){const{data:t}=this.$refs.signaturePad.saveSignature();var e="";t&&(e=t.replace("data:","").replace(/^.+,/,""));const a=this.$refs.signaturePad.toData();this.signature.image=e,this.signature.data_arr=a,this.saveFormData()},onEnd(){this.save()},async saveFormData(t){t+=1;var e=this.$data,a=JSON.stringify(e);if(a=JSON.parse(a),isNaN(t)){let t=1;while(await(0,at.U2)("VH-"+this.vh_id+"-"+t))void 0===a.appartements[t-1]&&await(0,at.IV)("VH-"+this.vh_id+"-"+t),t+=1;t=1;while(a.appartements[t-1])await(0,at.t8)("VH-"+this.vh_id+"-"+t,a.appartements[t-1]),t+=1}else await(0,at.t8)("VH-"+this.vh_id+"-"+t,a.appartements[t-1]);await(0,at.t8)("VH-"+this.vh_id,a)},async getFormData(){let t=1,e=[];if(void 0!==await(0,at.U2)("VH-"+this.vh_id+"-"+t)){while(void 0!==await(0,at.U2)("VH-"+this.vh_id+"-"+t)){let a=await(0,at.U2)("VH-"+this.vh_id+"-"+t);e[t-1]=a,t+=1}this.appartements=e}if(void 0!==await(0,at.U2)("VH-"+this.vh_id)){let t=await(0,at.U2)("VH-"+this.vh_id);this.remarque=t.remarque,this.compte_rendu=t.compte_rendu,this.signature=t.signature,this.temps_passe=t.temps_passe}this.saveFormData()},removeLine(t){confirm("Voulez-vous supprimer cette ligne ?")&&(this.appartements.splice(t,1),this.saveFormData())},addItemAppartements(){var t=this.appartements[0],e=t.num;this.appartements.unshift({num:Number(e)+1,bat:t.bat,nom:"",escalier:t.escalier,etage:t.etage,porte:"",suivi:"",signature:{image:"",data_arr:{}},remarque_inter:"",statut:"Clôturé",remarque:"",inter:[{inter_type:"",inter_lieu:"",inter_presta:"",inter_qty:"1"}],temps_passe:"0",verif_ra:!1,verif_rob:!1,verif_wc:!1,verif_gen:!1}),this.saveFormData()},submitForm(){const t={appartements:this.appartements,temps_passe:this.temps_passe,compte_rendu:this.compte_rendu,vh_id:this.vh_id,ctr_code:this.resp.Ctr_code,ctr_nature:this.resp.Ctr_nature,remarque:this.remarque,signature:this.signature};console.log(t),confirm("FINALISER LA VISITE. Vous allez envoyer les données au siège, vous ne pourrez plus accéder à cette VH.")&&nt.Z.post(this.currIp+"/submit_vh",t).then((t=>{console.log(t.data),200==t.status&&this.$router.push("/")}))}}},it=a(5312);const lt=(0,it.Z)(rt,[["render",et],["__scopeId","data-v-a43eb702"]]);var st=lt,ot={name:"VHView",components:{VH:st}};const _t=(0,it.Z)(ot,[["render",i]]);var ut=_t},3630:function(t,e,a){t.exports=a.p+"img/fleche2_blanc.dac177de.svg"},2957:function(t,e,a){t.exports=a.p+"img/logo-gereco-2.012b9603.svg"}}]);
//# sourceMappingURL=461.2e30632b.js.map