"use strict";(self["webpackChunkwpa_gereco"]=self["webpackChunkwpa_gereco"]||[]).push([[805],{6805:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ne}});var a=n(8473);const o={class:"NewDP"};function i(e,t,n,i,l,r){const s=(0,a.up)("NewDP");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(s,{msg:"Welcome to Your Vue.js App"})])}var l=n(9197),r=n(4887),s=n(3630),d=n(2957);const u=e=>((0,a.dD)("data-v-7e473d0e"),e=e(),(0,a.Cn)(),e),p={class:"form_header"},_=(0,a.uE)('<div class="header_headline" data-v-7e473d0e><a href="/" data-v-7e473d0e><img class="return_button" src="'+s+'" data-v-7e473d0e></a><img src="'+d+'" data-v-7e473d0e></div><div style="font-size:19px;color:white;font-weight:bold;" data-v-7e473d0e>NOUVEAU DÉPANNAGE</div>',2),c={class:"form_bloc"},v=u((()=>(0,a._)("div",{class:"form_bloc_title"},"Occupant",-1))),m={class:"form_bloc_content table_container"},h={class:"recur_table"},g=u((()=>(0,a._)("tr",null,[(0,a._)("th",null,"Nom"),(0,a._)("th",null,"Bât"),(0,a._)("th",null,"Esc")],-1))),b=u((()=>(0,a._)("tr",null,[(0,a._)("th",null,"Et"),(0,a._)("th",null,"Pte"),(0,a._)("th",null,"Code")],-1))),y={class:"form_bloc"},D=u((()=>(0,a._)("div",{class:"form_bloc_title"},"Remarques (informations à modifier)",-1))),f={class:"form_bloc_content"},w={class:"form_bloc intervention",style:{"margin-top":"40px"}},P=u((()=>(0,a._)("div",{class:"form_bloc_title"},"Intervention",-1))),C={class:"form_bloc_content"},V={class:"intervention_type"},O={class:"intervention_bloc"},x=u((()=>(0,a._)("tr",null,[(0,a._)("th",null,"Lieu"),(0,a._)("th",null,"Famille"),(0,a._)("th",null,"Presta."),(0,a._)("th",null,"Qté.")],-1))),E=["onUpdate:modelValue"],U=(0,a.uE)("<option data-v-7e473d0e></option><option data-v-7e473d0e>WC</option><option data-v-7e473d0e>WCLAVEMAIN</option><option data-v-7e473d0e>Cuis.</option><option data-v-7e473d0e>Ch</option><option data-v-7e473d0e>SD</option><option data-v-7e473d0e>SDLAVABO</option><option data-v-7e473d0e>SDDOUCHE</option><option data-v-7e473d0e>SDB</option><option data-v-7e473d0e>SDBLAVABO</option><option data-v-7e473d0e>SDBBAIGN</option><option data-v-7e473d0e>SDBDOUCHE</option><option data-v-7e473d0e>SDBBIDET</option><option data-v-7e473d0e>VO</option><option data-v-7e473d0e>Part.Comm.</option>",15),I=[U],q=["onUpdate:modelValue"],N=u((()=>(0,a._)("option",{value:"1"},"RA - Robinet arrêt",-1))),A=u((()=>(0,a._)("option",{value:"4"},"WC",-1))),R=u((()=>(0,a._)("option",{value:"3"},"ROB - Robinetterie",-1))),k=u((()=>(0,a._)("option",{value:"5"},"GENER - Générique",-1))),B=[N,A,R,k],S=["onUpdate:modelValue","disabled"],F=["value"],M=["onUpdate:modelValue","disabled"],L=u((()=>(0,a._)("label",{style:{}},"Remarque si autre Lieu ou autre robinetterie: ",-1))),T=u((()=>(0,a._)("br",null,null,-1))),G={class:"more_inter_container"},W={class:"more_inter_container"},z={class:"form_bloc intervention"},j=u((()=>(0,a._)("div",{class:"form_bloc_title"},"Compte rendu / Commentaires :",-1))),H={class:"form_bloc_content"},Z={id:"intervention",style:{"margin-bottom":"20px"}},$=u((()=>(0,a._)("label",null,"Accès porte",-1))),Y=u((()=>(0,a._)("option",null,"Occupant",-1))),K=u((()=>(0,a._)("option",null,"Gardien",-1))),Q=u((()=>(0,a._)("option",null,"Clé",-1))),J=u((()=>(0,a._)("option",null,"Absent",-1))),X=u((()=>(0,a._)("option",null,"Refus oral",-1))),ee=u((()=>(0,a._)("option",null,"Avisé",-1))),te=[Y,K,Q,J,X,ee],ne={style:{"margin-bottom":"20px"}},ae=u((()=>(0,a._)("label",null,"Observations :",-1))),oe={id:"intervention"},ie=u((()=>(0,a._)("label",null,"Statut intervention :",-1))),le=u((()=>(0,a._)("option",null,"Clôturé",-1))),re=u((()=>(0,a._)("option",null,"En suspens",-1))),se=[le,re],de={style:{"margin-bottom":"20px"}},ue=u((()=>(0,a._)("label",{for:"checkbox_devis"},"Devis à faire",-1))),pe=u((()=>(0,a._)("br",null,null,-1))),_e={style:{"margin-bottom":"20px"}},ce=u((()=>(0,a._)("label",null,"Temps passé (hors déplacement)* :",-1))),ve=(0,a.uE)('<option value="15" data-v-7e473d0e>15min</option><option value="30" data-v-7e473d0e>30min</option><option value="45" data-v-7e473d0e>45min</option><option value="60" data-v-7e473d0e>1h</option><option value="75" data-v-7e473d0e>1h15min</option><option value="90" data-v-7e473d0e>1h30min</option><option value="105" data-v-7e473d0e>1h45min</option><option value="120" data-v-7e473d0e>2h</option><option value="135" data-v-7e473d0e>2h15min</option><option value="150" data-v-7e473d0e>2h30min</option><option value="165" data-v-7e473d0e>2h45min</option><option value="180" data-v-7e473d0e>3h</option><option value="195" data-v-7e473d0e>3h15min</option><option value="210" data-v-7e473d0e>3h30min</option><option value="225" data-v-7e473d0e>3h45min</option><option value="240" data-v-7e473d0e>4h</option>',16),me=[ve],he={style:{"margin-bottom":"20px"}},ge=u((()=>(0,a._)("label",null,"Photo de l'intervention :",-1))),be=u((()=>(0,a._)("br",null,null,-1))),ye=["src"],De=u((()=>(0,a._)("label",{style:{}},"Visa Gardien ou Représentant",-1))),fe={style:{display:"flex","justify-content":"center"}},we=u((()=>(0,a._)("input",{class:"input_button",type:"submit",value:"TERMINER L'INTERVENTION",style:{"margin-top":"20px"}},null,-1)));function Pe(e,t,n,o,i,s){const d=(0,a.up)("VueSignaturePad");return(0,a.wg)(),(0,a.iD)("form",{onSubmit:t[17]||(t[17]=(0,l.iM)(((...e)=>s.getFormValues&&s.getFormValues(...e)),["prevent"]))},[(0,a._)("div",p,[_,(0,a._)("div",c,[v,(0,a._)("div",m,[(0,a._)("div",h,[(0,a._)("table",null,[g,(0,a._)("tr",null,[(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>i.occupant.DPOC_occupant=e)},null,512),[[l.nr,i.occupant.DPOC_occupant]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>i.occupant.DPOC_bat=e)},null,512),[[l.nr,i.occupant.DPOC_bat]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>i.occupant.DPOC_escalier=e)},null,512),[[l.nr,i.occupant.DPOC_escalier]])])])]),(0,a._)("table",null,[b,(0,a._)("tr",null,[(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>i.occupant.DPOC_etage=e)},null,512),[[l.nr,i.occupant.DPOC_etage]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>i.occupant.DPOC_porte=e)},null,512),[[l.nr,i.occupant.DPOC_porte]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>i.occupant.DPOC_codeAcces=e)},null,512),[[l.nr,i.occupant.DPOC_codeAcces]])])])])])])]),(0,a._)("div",y,[D,(0,a._)("div",f,[(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":t[6]||(t[6]=e=>i.DP_remarqueContractuelle=e)},null,512),[[l.nr,i.DP_remarqueContractuelle]])])])]),(0,a._)("div",w,[P,(0,a._)("div",C,[(0,a._)("div",V,[(0,a._)("div",O,[(0,a._)("table",null,[x,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.inter,((t,n)=>((0,a.wg)(),(0,a.iD)("tr",{key:n},[(0,a._)("td",null,[(0,a.wy)((0,a._)("select",{style:{width:"50px"},"onUpdate:modelValue":e=>t["inter_lieu"]=e},I,8,E),[[l.bM,t["inter_lieu"]]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("select",{style:{width:"75px"},"onUpdate:modelValue":e=>t["inter_type"]=e},B,8,q),[[l.bM,t["inter_type"]]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("select",{"onUpdate:modelValue":e=>t["inter_presta"]=e,disabled:""!=t["inter_type"]&&""!=t["inter_lieu"]?e.disabled:""},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.inter_option["presta_fam"+t["inter_type"]],(e=>((0,a.wg)(),(0,a.iD)("option",{key:e,value:e.id},(0,r.zw)(e.libelle),9,F)))),128))],8,S),[[l.bM,t["inter_presta"]]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{style:{width:"15px"},type:"number","onUpdate:modelValue":e=>t["inter_qty"]=e,disabled:""!=t["inter_lieu"]&&""!=t["inter_type"]?e.disabled:""},null,8,M),[[l.nr,t["inter_qty"]]])])])))),128))]),(0,a._)("p",null,[L,T,(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>i.DP_remarqueInter=e)},null,512),[[l.nr,i.DP_remarqueInter]])]),(0,a._)("div",G,[(0,a._)("a",{href:"#",class:"add-more-inter",onClick:t[8]||(t[8]=(0,l.iM)(((...e)=>s.addItem&&s.addItem(...e)),["prevent"]))},"+")]),(0,a._)("div",W,[(0,a._)("a",{href:"#",class:"add-more-inter",onClick:t[9]||(t[9]=(0,l.iM)(((...e)=>s.removeItem&&s.removeItem(...e)),["prevent"]))},"-")])])])])]),(0,a._)("div",z,[j,(0,a._)("div",H,[(0,a._)("div",Z,[$,(0,a.wy)((0,a._)("select",{"onUpdate:modelValue":t[10]||(t[10]=e=>this.acces_porte=e)},te,512),[[l.bM,this.acces_porte]])]),(0,a._)("div",ne,[ae,(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":t[11]||(t[11]=e=>i.DP_observations=e)},null,512),[[l.nr,i.DP_observations]])]),(0,a._)("div",oe,[ie,(0,a.wy)((0,a._)("select",{"onUpdate:modelValue":t[12]||(t[12]=e=>this.statut=e)},se,512),[[l.bM,this.statut]])]),(0,a._)("div",de,[(0,a.wy)((0,a._)("input",{type:"checkbox",name:"checkbox_devis","onUpdate:modelValue":t[13]||(t[13]=e=>this.raf_devis=e)},null,512),[[l.e8,this.raf_devis]]),ue,pe]),(0,a._)("div",_e,[ce,(0,a.wy)((0,a._)("select",{"onUpdate:modelValue":t[14]||(t[14]=e=>this.temps_passe=e)},me,512),[[l.bM,this.temps_passe]])]),(0,a._)("div",he,[ge,be,(0,a._)("input",{type:"file",id:"image_upload",name:"image",onChange:t[15]||(t[15]=(...e)=>s.handleFiles&&s.handleFiles(...e)),accept:"image/png, image/jpeg"},null,32)]),""!=this.image?((0,a.wg)(),(0,a.iD)("img",{key:0,src:"data:image/png;base64 ,"+this.image,style:{width:"60px","margin-bottom":"30px"}},null,8,ye)):(0,a.kq)("",!0),De,(0,a._)("div",null,[(0,a.Wm)(d,{onChange:s.save,height:"200px",class:"signaturePad",ref:"signaturePad",style:{width:"70%",margin:"auto"},options:{onBegin:e.onBegin,onEnd:s.onEnd}},null,8,["onChange","options"]),(0,a._)("div",fe,[(0,a._)("div",{onClick:t[16]||(t[16]=(...e)=>s.undo&&s.undo(...e))},"Effacer")])])])]),we],32)}n(7658);var Ce=n(5633),Ve=n(8736),Oe={name:"NewDP",data(){return{tech_id:"",DP_observations:"",DP_remarqueContractuelle:"",DP_remarqueInter:"",temps_passe:"",statut:"",image:"",signature:{image:"",data_arr:{}},raf_devis:!1,acces_porte:"",inter_option:[],inter:[{inter_type:"",inter_lieu:"",inter_presta:"",inter_qty:"1"}],occupant:{DPOC_bat:"",DPOC_codeAcces:"",DPOC_escalier:"",DPOC_etage:"",DPOC_occupant:"",DPOC_porte:""},currIp:this.currIp}},async mounted(){let e=await(0,Ve.U2)("current_tech");this.tech_id=e,Ce.Z.get(this.currIp+"/get_all_presta").then((e=>{this.inter_option=e.data,console.log(this.inter_option)})),window.addEventListener("beforeunload",this.saveFormData)},beforeUnmount(){window.removeEventListener("beforeunload",this.saveFormData)},methods:{undo(){this.$refs.signaturePad.clearSignature(),this.save()},save(){const{data:e}=this.$refs.signaturePad.saveSignature();var t="";e&&(t=e.replace("data:","").replace(/^.+,/,""));const n=this.$refs.signaturePad.toData();this.signature.image=t,this.signature.data_arr=n,console.log(this.occupant)},onEnd(){this.save()},getFormValues(){const e={DP_remarqueContractuelle:this.DP_remarqueContractuelle,DP_remarqueInter:this.DP_remarqueInter,DP_observations:this.DP_observations,temps_passe:this.temps_passe,statut:this.statut,acces_porte:this.acces_porte,tech_id:this.tech_id,raf_devis:this.raf_devis,inter:this.inter,occupant:this.occupant,signature:this.signature,image:this.image};console.log(e),confirm("TERMINER L'INTERVENTION. Vous allez envoyer les données au siège, vous ne pourrez plus accéder à cette DP.")&&Ce.Z.post(this.currIp+"/submit_new_dp",e).then((e=>{console.log(e.data),200==e.status&&this.$router.push("/")}))},addItem(){if(void 0!=this.inter[this.inter.length-1]){var e=this.inter[this.inter.length-1];""!=e.inter_type&&""!=e.inter_lieu&&""!=e.inter_presta&&""!=e.inter_qty?this.inter.push({inter_type:"",inter_lieu:"",inter_presta:"",inter_qty:""}):alert("Vous devez remplir l'intervention précédente avant d'en rajouter une nouvelle")}else this.inter.push({inter_type:"",inter_lieu:"",inter_presta:"",inter_qty:""});this.saveFormData()},removeItem(){this.inter.pop(),this.saveFormData()},async handleFiles(e){var t=await e.target.files||await e.dataTransfer.files,n=t[0];const a=new FileReader;a.onloadend=()=>{const e=a.result.replace("data:","").replace(/^.+,/,"");this.image=e,console.log(this.image)},a.readAsDataURL(n)}}},xe=n(5312);const Ee=(0,xe.Z)(Oe,[["render",Pe],["__scopeId","data-v-7e473d0e"]]);var Ue=Ee,Ie={name:"NewDPView",components:{NewDP:Ue}};const qe=(0,xe.Z)(Ie,[["render",i]]);var Ne=qe},3630:function(e,t,n){e.exports=n.p+"img/fleche2_blanc.dac177de.svg"},2957:function(e,t,n){e.exports=n.p+"img/logo-gereco-2.012b9603.svg"}}]);
//# sourceMappingURL=805.ee90f3ef.js.map